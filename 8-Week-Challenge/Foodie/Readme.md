<h1 align="center">🍽️ Foodie-Fi SQL Case Study</h1>
<p align="center">
  <i>Part of the <a href="https://8weeksqlchallenge.com/">8 Week SQL Challenge</a> by Danny Ma</i><br>
  <b>Case Study #3 – Foodie-Fi</b>
</p>

---

## 🧰 Tech Stack
<p align="center">
  <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/mysql/mysql-original-wordmark.svg" width="60" alt="MySQL"/>
  <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/vscode/vscode-original.svg" width="50" alt="VS Code"/>
  <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/github/github-original.svg" width="50" alt="GitHub"/>
  <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/linux/linux-original.svg" width="50" alt="Linux"/>
  <img src="https://upload.wikimedia.org/wikipedia/commons/7/7f/Microsoft_Office_Excel_%282019–present%29.svg" width="50" alt="Excel"/>
</p>

---

## 📘 Overview
**Foodie-Fi** is a subscription-based streaming platform for food lovers 🍕🍣🍔.  
Danny wants to analyze **customer subscriptions, plan transitions, churn, and revenue patterns** to make informed business decisions.  
This case study explores SQL queries to gain insights into user behavior and growth trends.

---

## 🧩 Entity Relationship Diagram (ERD)
<p align="center">
  <img src="./foodie_fi_ER.png" alt="Foodie-Fi ER Diagram" width="500"/>
</p>

| Table | Description |
|:--|:--|
| **plans** | Contains details about subscription plans (`plan_id`, `plan_name`, `price`) |
| **subscriptions** | Tracks each customer’s plan and start date |

---

## 💡 Business Questions & SQL Solutions
All queries are from [`foodie_fi.sql`](./foodie_fi.sql)

### 1️⃣ How many customers have ever subscribed to Foodie-Fi?
```sql
SELECT COUNT(DISTINCT customer_id) AS total_customers FROM subscriptions;
```
### 2️⃣ What is the distribution of customers across different plan types?
```sql
SELECT p.plan_name, COUNT(s.customer_id) AS total_customers FROM subscriptions s JOIN plans p ON s.plan_id = p.plan_id GROUP BY p.plan_name ORDER BY total_customers DESC;
```
### 3️⃣ How many customers upgraded to the Pro Annual plan?
```sql
SELECT COUNT(DISTINCT customer_id) AS pro_annual_customers FROM subscriptions WHERE plan_id = 3;
```
### 4️⃣ How many customers churned (canceled their subscription)?
```sql
SELECT COUNT(DISTINCT customer_id) AS churned_customers FROM subscriptions WHERE plan_id = 4;
```
### 5️⃣ What percentage of customers churned vs retained?
```sql
SELECT ROUND((SUM(CASE WHEN plan_id = 4 THEN 1 ELSE 0 END) / COUNT(DISTINCT customer_id)) * 100, 2) AS churn_rate, ROUND((SUM(CASE WHEN plan_id != 4 THEN 1 ELSE 0 END) / COUNT(DISTINCT customer_id)) * 100, 2) AS retention_rate FROM subscriptions;
```
### 6️⃣ What is the average time to upgrade from the free trial to a paid plan?
```sql
WITH plan_changes AS (SELECT customer_id, MIN(start_date) AS free_trial_date, MAX(CASE WHEN plan_id IN (1, 2, 3) THEN start_date END) AS paid_date FROM subscriptions GROUP BY customer_id) SELECT ROUND(AVG(DATEDIFF(paid_date, free_trial_date))) AS avg_days_to_upgrade FROM plan_changes;
```
### 7️⃣ Which plan generates the highest revenue?
```sql
SELECT p.plan_name, SUM(p.price) AS total_revenue FROM subscriptions s JOIN plans p ON s.plan_id = p.plan_id WHERE p.price > 0 GROUP BY p.plan_name ORDER BY total_revenue DESC;
```
### 8️⃣ What is the total revenue generated by Foodie-Fi?
```sql
SELECT CONCAT('$', FORMAT(SUM(price), 2)) AS total_revenue FROM subscriptions s JOIN plans p ON s.plan_id = p.plan_id;
```
### 9️⃣ What is the customer retention trend over time?
```sql
SELECT YEAR(start_date) AS year, MONTH(start_date) AS month, COUNT(DISTINCT customer_id) AS active_customers FROM subscriptions WHERE plan_id != 4 GROUP BY year, month ORDER BY year, month;
```
### 🔟 Which month had the highest churn rate?
```sql
SELECT MONTH(start_date) AS churn_month, COUNT(DISTINCT customer_id) AS churned_customers FROM subscriptions WHERE plan_id = 4 GROUP BY churn_month ORDER BY churned_customers DESC LIMIT 1;
```
### 1️⃣1️⃣ How many customers converted from the free trial to a paid plan?
```sql
WITH conversion AS (SELECT customer_id, COUNT(DISTINCT CASE WHEN plan_id != 0 AND plan_id != 4 THEN plan_id END) AS paid_plans FROM subscriptions GROUP BY customer_id) SELECT COUNT(*) AS converted_customers FROM conversion WHERE paid_plans > 0;
```
### 1️⃣2️⃣ What is the most popular upgrade path (Free → Plan)?
```sql
SELECT p.plan_name, COUNT(*) AS upgrades FROM subscriptions s JOIN plans p ON s.plan_id = p.plan_id WHERE s.plan_id IN (1, 2, 3) GROUP BY p.plan_name ORDER BY upgrades DESC;
```
### 1️⃣3️⃣ What percentage of customers upgraded from Monthly to Annual?
```sql
WITH monthly_to_annual AS (SELECT customer_id FROM subscriptions GROUP BY customer_id HAVING SUM(plan_id = 2) > 0 AND SUM(plan_id = 3) > 0) SELECT COUNT(*) AS upgraded_customers, ROUND((COUNT(*) / (SELECT COUNT(DISTINCT customer_id) FROM subscriptions)) * 100, 2) AS upgrade_percentage FROM monthly_to_annual;
```
### 1️⃣4️⃣ What is the average number of days between plan changes?
```sql
WITH plan_steps AS (SELECT customer_id, plan_id, start_date, LEAD(start_date) OVER (PARTITION BY customer_id ORDER BY start_date) AS next_date FROM subscriptions) SELECT ROUND(AVG(DATEDIFF(next_date, start_date))) AS avg_days_between_changes FROM plan_steps WHERE next_date IS NOT NULL;
```

---

## 📊 Key Insights
- 🎯 **Free Trial → Paid conversion** rate is strong  
- 💸 **Pro Annual Plan** contributes the most revenue  
- ⏱️ Average upgrade time: ~9 days  
- 📈 **Retention** is strong, **churn** remains low  
- 🔁 Opportunity to upsell **Monthly → Annual** subscriptions  

---

## 📂 Repository Structure
```
📁 Foodie-Fi
│
├── foodie_fi.sql
├── foodie_fi_ER.png
└── README.md
```

---

## 🔗 References
- Challenge → [8 Week SQL Challenge – Case Study #3](https://8weeksqlchallenge.com/case-study-3/)  
- ER Diagram → [dbdiagram.io](https://dbdiagram.io)

---

## ✨ Author
**Sumit Kumar**  
📎 [GitHub](https://github.com/suku-na)  

---

<h3 align="center">⚡ “Data tells a story — and SQL helps us read it better.” ⚡</h3>
<p align="center">
  <em>Thank you for exploring this project — feel free to check my other SQL case studies!</em>
</p>
